<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.69.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>Problem 1: Multiples of 3 and 5&nbsp;&ndash;&nbsp;Project Euler Solutions</title><link rel=stylesheet href=../../css/core.min.25a02793b61d1ffba13ee0ff5f7acd391b938d6875782c46352d469ae881aac460bc55be72396f751a0095da57213cac.css integrity=sha384-JaAnk7YdH/uhPuD/X3rNORuTjWh1eCxGNS1GmuiBqsRgvFW+cjlvdRoAldpXITys><meta name=twitter:card content="summary"><meta name=twitter:title content="Problem 1: Multiples of 3 and 5"><body><div class=base-body><section id=header class="site header"><div class="header wrap"><span class="header left-side"><a class="site home" href=../../><span class="site name">Project Euler Solutions</span></a></span>
<span class="header right-side"></span></div></section><div id=content><div class=article-container><section class="article header"><h1 class="article title">Problem 1: Multiples of 3 and 5</h1></section><article class="article markdown-body"><p>Sequence summation for multiples of numbers from one to <em>n</em></p><h2 id=description>Description</h2><blockquote><p>If we list all the natural numbers below 10 that are multiples of 3 or 5, we get
3, 5, 6 and 9. The sum of these multiples is 23.</p><p>Find the sum of all the multiples of 3 or 5 below 1000.</p></blockquote><h2 id=iterative-solution>Iterative solution</h2><p>A naive, albeit effective for this input size, method to solve this would be to
iterate from 1 to <em>n</em>, skip numbers that are not multiples of three and five,
and sum the remaining set of numbers. Starting at three rather than one is a
trivial but appropriate improvement.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=n>solve</span><span class=o>!</span><span class=p>(</span><span class=n>p001</span><span class=p>,</span><span class=w> </span><span class=n>iterative</span><span class=p>,</span><span class=w> </span><span class=mi>1_000</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>n</span><span class=o>|</span><span class=w> </span>-&gt; <span class=nc>i128</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=p>(</span><span class=mi>3</span><span class=p>..</span><span class=n>n</span><span class=p>).</span><span class=n>filter</span><span class=p>(</span><span class=o>|</span><span class=n>m</span><span class=o>|</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>).</span><span class=n>sum</span><span class=p>()</span><span class=w>
</span><span class=w></span><span class=p>});</span><span class=w>
</span></code></pre></div><p>This solution scales linearly with the input size.</p><h2 id=closed-form-solution>Closed form solution</h2><p>We can implement a closed form solution with some number theory. A closed form
solution is one that scales in constant time with respect to the input.</p><p>The first step is to find an efficient way to sum consecutive numbers, beginning
from one. Let&rsquo;s take \(n = 6\) as an example.</p><p>\[ \sum_{i=1}^6 i = 1 + 2 + 3 + 4 + 5 + 6 \]</p><p>Observe that we can pair these numbers up \(\frac{n}{2}\) times and that they
all equal \(n + 1\).</p><p>\[
1 + 6 = 7 \newline
2 + 5 = 7 \newline
3 + 4 = 7 \newline
\]</p><p>For odd numbers, let&rsquo;s say \(n = 7\), add a pair including zero.</p><p>\[
0 + 7 = 7 \newline
1 + 6 = 7 \newline
2 + 5 = 7 \newline
3 + 4 = 7
\]</p><p>Now there are \(\frac{n + 1}{2}\) pairs and each pair adds up to \(n\). The
result is the same because of the distributive property in arithmetic.</p><p>\[ \frac{n}{2} \cdot (n + 1) \equiv \frac{n + 1}{2} \cdot n \]</p><p>We now want to formerly prove this so we can apply the formula for any value of
\(n\).</p><p>\[ S_n = \frac{n(n + 1)}{2}, \quad \text{for } n \in \natnums_0 \]</p><p>A statement like this is known as a proposition. One way to prove a proposition
is with mathematical induction on recurrence relations. Recurrence relations
are equations that define a given term \(n\) in terms of a previous term. By
definition, they are recursive, so a base case must also be defined.</p><p>\[\begin{aligned}
S_0 &= 0
\\ S_n &= S_{n - 1} + n, \quad \text{for } n \in \natnums_1
\end{aligned}\]</p><p>The truth of these equations is self-evident. To prove the proposition, we
substitute it into these equations.</p><p>\[\begin{aligned}
S_0 &= 0
\\ &= \frac{0 \cdot (0 + 1)}{2} \newline \newline
\\[2em] S_n &= S_{n - 1} + n
\\ &= \frac{(n - 1)((n - 1) + 1)}{2} + n
\end{aligned}\]</p><p>The first equation holds. The second one holds only if we can arrive back to
the proposition algebraically.</p><p>\[\begin{aligned}
S_n &= \frac{(n - 1)((n - 1) + 1)}{2} + n
\\ &= \frac{(n - 1)(n)}{2} + \frac{2n}{2}
\\ &= \frac{n(n - 1) + 2n}{2}
\\ &= \frac{n(n - 1 + 2)}{2}
\\ &= \frac{n(n + 1)}{2}
\end{aligned}\]</p><p>Since the second equation holds, we have found the closed form solution and can
now implement this without a looping construct.</p><p>But of course, the problem wants us to sum multiples. For example, the sum of
multiples of five up to and including thirty.</p><p>\[\begin{aligned}
M_6(30, 5) &= 5 + 10 + 15 + 20 + 25 + 30
\\ &= 105
\end{aligned}\]</p><p>It&rsquo;s important to recognise that \(n\) represents the number of terms here, not
the limit value that we want to sum the multiples to. If we denote the limit
value \(l = 30\) and the difference between each term \(d = 5\), then \(n =
\tfrac{l}{d} = 6\).</p><p>Just as important, note that \(d\) can be factored out of the sequence.</p><p>\[\begin{aligned}
M_6(30, 5) &= 5(1 + 2 + 3 + 4 + 5 + 6)
\\ &= 105
\end{aligned}\]</p><p>We can use our existing knowledge of \(S_n\) here.</p><p>\[
M_n(l, d) = d \cdot S_{\frac{l}{d}}
\]</p><p>Let&rsquo;s write a new proposition in terms of \(n\) to prepare for our proof.</p><p>\[\begin{aligned}
M_{n}(l, d) &= d \cdot S_{\frac{l}{d}}
\\ &= d \cdot \frac{\tfrac{l}{d}(\tfrac{l}{d} + 1)}{2}
\\ &= d \cdot \frac{n(n + 1)}{2}
\\ &= \frac{nd(n + 1)}{2}
\end{aligned}\]</p><p>Defining the new recurrence in terms of \(n\) simplifies it.</p><p>\[\begin{aligned}
M_0(l, d) &= 0
\\ M_n(l,d) &= M_{n-1} + nd, \quad \text{for } n \in \natnums_1, d \in \natnums_1
\end{aligned}\]</p><p>The proof is once again by mathematical induction.</p><p>\[\begin{aligned}
M_{0}(l, d) &= 0
\\ &= \frac{0 \cdot d \cdot (0 + 1)}{2}
\\[1em]
\\ M_{n}(l, d) &= M_{n-1} + nd
\\ &= \frac{(n - 1) \cdot d \cdot ((n - 1) + 1)}{2} + \frac{2nd}{2}
\\ &= \frac{d(n - 1)(n) + 2nd}{2}
\\ &= \frac{nd(n - 1) + 2nd}{2}
\\ &= \frac{nd(n - 1 + 2)}{2}
\\ &= \frac{nd(n + 1)}{2}
\end{aligned}\]</p><p>Since the equations hold, let&rsquo;s rewrite our solution in terms of \(l\) and
\(d\) as these are the inputs to our implementation.</p><p>\[\begin{aligned}
M_{n}(l, d) &= d \cdot \frac{\tfrac{l}{d}(\tfrac{l}{d} + 1)}{2}
\\ &= \frac{l(\tfrac{l}{d} + 1)}{2}
\\ &= \frac{l(\tfrac{l + d}{d})}{2}
\\ &= \frac{l(l + d)}{2d}
\end{aligned}\]</p><p>And with that, we can finally implement a closed form solution.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=n>solve</span><span class=o>!</span><span class=p>(</span><span class=n>p001</span><span class=p>,</span><span class=w> </span><span class=n>closed</span><span class=p>,</span><span class=w> </span><span class=mi>1_000</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>exclusive_limit</span><span class=o>|</span><span class=w> </span>-&gt; <span class=nc>i128</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>sum_multiples</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>|</span><span class=n>difference</span><span class=o>|</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>limit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>difference</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>((</span><span class=n>exclusive_limit</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>difference</span><span class=p>);</span><span class=w>
</span><span class=w>	</span><span class=p>(</span><span class=n>limit</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>limit</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>difference</span><span class=p>))</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>difference</span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>sum_of_multiples</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=p>[</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=p>].</span><span class=n>iter</span><span class=p>().</span><span class=n>map</span><span class=p>(</span><span class=n>sum_multiples</span><span class=p>).</span><span class=n>sum</span><span class=p>();</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>sum_of_product_multiples</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sum_multiples</span><span class=p>(</span><span class=o>&amp;</span><span class=p>(</span><span class=mi>3</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>5</span><span class=p>));</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=p>(</span><span class=n>sum_of_multiples</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>sum_of_product_multiples</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>i128</span><span class=w>
</span><span class=w></span><span class=p>});</span><span class=w>
</span></code></pre></div><p>Take care to decrement the limit value since the problem statement asks for
multiples <em>up to</em> one thousand. Dividing and then multiplying by <code>difference</code>
ensures <code>limit</code> is a multiple of <code>difference</code>. Once the multiples of three and
five are summed, the answer will include the multiples of their product twice,
so the sum of multiples of fifteen is calculated separately and subtracted from
the answer.</p><h2 id=comparison>Comparison</h2><p>The closed form solution runs in constant time in contrast with the iterative
solution that scales linearly with the size of the limit value.</p><span class=image-container><span class=link><a href=../../images/p001_comparison.svg target=_blank><img class=img src=../../images/p001_comparison.svg></a></span></span><p>With limit values in the thousands or lower, the iterative solution still
completes in microseconds. With far larger limit values, the delay would begin
to become noticeable.</p></article></div></div><section id=footer class=footer><div class=footer-wrap><p class=copyright>© 2020 Krishan Wyse</p><p class=powerby><span>Powered by </span><a href=https://gohugo.io target=_blank>Hugo</a><span> and the </span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p></div></section><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body);></script></div></body></html>